<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOD-CLEANER・GOLD 導入LP | サロン集客・売上アップ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        html { scroll-behavior: smooth; }
        .chart-container { 
            position: relative; 
            width: 100%; 
            max-width: 500px; 
            margin-left: auto; 
            margin-right: auto; 
            height: 300px; 
            max-height: 350px; 
        }
        @media (min-width: 768px) { 
            .chart-container { height: 350px; } 
        }
        .placeholder-bg {
            background-color: #E0E0E0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #757575;
            font-size: 0.875rem;
            text-align: center;
            border-radius: 0.5rem;
            min-height: 200px;
        }
        
        /* スマホ表示の最適化 */
        @media (max-width: 767px) {
            body {
                font-size: 15px;
                line-height: 1.6;
            }
            h1 {
                font-size: 1.75rem !important;
                line-height: 1.3;
            }
            h2 {
                font-size: 1.5rem !important;
                line-height: 1.3;
            }
            h3 {
                font-size: 1.25rem !important;
            }
            h4 {
                font-size: 1.125rem !important;
            }
            .text-4xl {
                font-size: 2rem !important;
            }
            .text-3xl {
                font-size: 1.75rem !important;
            }
            .text-2xl {
                font-size: 1.5rem !important;
            }
            .text-xl {
                font-size: 1.125rem !important;
            }
            .text-lg {
                font-size: 1rem !important;
            }
            p {
                font-size: 0.9375rem;
            }
        }
    </style>
</head>
<body class="bg-orange-50 text-gray-800 font-sans">

    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center h-16 md:h-20">
            <div class="text-lg md:text-2xl font-bold text-amber-600">
                GOD-CLEANER・GOLD
            </div>
            <div class="hidden md:flex space-x-6">
                <a href="#problem" class="text-gray-600 hover:text-amber-600 transition-colors">サロンの悩み</a>
                <a href="#solution" class="text-gray-600 hover:text-amber-600 transition-colors">選ばれる理由</a>
                <a href="#voice" class="text-gray-600 hover:text-amber-600 transition-colors">導入事例</a>
                <a href="#offer" class="text-gray-600 hover:text-amber-600 transition-colors">導入特典</a>
            </div>
            <a href="#contact" class="bg-amber-600 text-white px-3 py-2 md:px-5 md:py-2.5 rounded-md text-sm md:text-base font-semibold hover:bg-amber-700 transition-colors shadow-lg">
                無料資料請求
            </a>
        </nav>
    </header>

    <main>
        <section id="hero" class="bg-white pb-20 pt-10">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="w-full h-auto mb-8 relative rounded-lg overflow-hidden shadow-2xl">
                   <a href="https://imgtu.com/ja/upload/jrgw1tfm/gc-g" target="_blank"><img src="https://imgtu.com/uploads/jrgw1tfm/r-gc-g.webp" alt="GC-G.jpg" border="0"/></a>

<div class="absolute inset-0 flex flex-col justify-center items-center text-center p-4 bg-black bg-opacity-30 text-white">
    <h1 class="text-2xl sm:text-3xl md:text-5xl font-bold tracking-tight mb-3 md:mb-4 px-2">
        集客の悩みを<br>
        「<strong>感動とリピート</strong>」で解決。
    </h1>
    <h2 class="text-lg sm:text-xl md:text-3xl font-semibold mb-4 md:mb-6 px-2">
        次世代デトックスマシン<br><span class="text-amber-400">GOD-CLEANER・GOLD</span>
    </h2>
</div>
                </div>
                
                <div class="text-center">
                    <p class="text-base md:text-lg lg:text-xl max-w-3xl mx-auto mb-6 md:mb-8 text-gray-700 px-4">
                        体験者の驚きが口コミを呼び、高単価・高リピート率を実現。
                        今、既存メニューとの組み合わせで売上が最大化する。
                    </p>
                    <a href="#contact" class="inline-block bg-amber-600 text-white px-6 py-3 md:px-10 md:py-4 rounded-md font-bold text-base md:text-lg hover:bg-amber-700 transition-colors shadow-xl">
                        無料資料請求・専門スタッフによる説明を希望する
                    </a>
                </div>
            </div>
        </section>

        <section id="problem" class="py-20 bg-orange-50">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">
                    「こんなお悩み、<span class="text-amber-600">ありませんか？</span>」
                </h2>
                <p class="text-center text-lg text-gray-700 max-w-2xl mx-auto mb-16">
                    多くのサロン経営者様が抱える共通の課題です。一つでも当てはまれば、GOD-CLEANER・GOLDがその解決策になるかもしれません。
                </p>
                <div class="max-w-3xl mx-auto space-y-6">
                    <div class="bg-white p-6 rounded-lg shadow-lg flex items-center transition-transform hover:scale-105">
                        <span class="text-red-500 font-bold text-3xl mr-5">✘</span>
                        <div>
                            <h3 class="text-xl font-semibold mb-1">集客コストが高い</h3>
                            <p class="text-gray-600">集客サイト頼みで、新規顧客の獲得コストが高騰している。</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg flex items-center transition-transform hover:scale-105">
                        <span class="text-red-500 font-bold text-3xl mr-5">✘</span>
                        <div>
                            <h3 class="text-xl font-semibold mb-1">他店との差別化</h3>
                            <p class="text-gray-600">既存メニューの差別化が難しく、価格競争に巻き込まれている。</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg flex items-center transition-transform hover:scale-105">
                        <span class="text-red-500 font-bold text-3xl mr-5">✘</span>
                        <div>
                            <h3 class="text-xl font-semibold mb-1">リピート率の低迷</h3>
                            <p class="text-gray-600">お客様のリピート率が上がらず、経営が安定しない。</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg flex items-center transition-transform hover:scale-105">
                        <span class="text-red-500 font-bold text-3xl mr-5">✘</span>
                        <div>
                            <h3 class="text-xl font-semibold mb-1">インパクト不足</h3>
                            <p class="text-gray-600">お客様に感動を与える、他にないインパクトのあるメニューが欲しい。</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg flex items-center transition-transform hover:scale-105">
                        <span class="text-red-500 font-bold text-3xl mr-5">✘</span>
                        <div>
                            <h3 class="text-xl font-semibold mb-1">技術への依存</h3>
                            <p class="text-gray-600">スタッフの技術レベルに依存しない、安定した売上を作りたい。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="solution" class="py-20 bg-white">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-6">
                    答えは、足元からお客様の体感を変える<br class="md:hidden">「<span class="text-amber-600">非日常体験</span>」
                </h2>
                <p class="text-center text-lg text-gray-700 max-w-3xl mx-auto mb-12">
                    GOD-CLEANER・GOLDとは、足をお湯に浸すだけで体内に溜まった老廃物や有害物質を排出に導くデトックス機器です。
                    その圧倒的な「結果の可視化」が、お客様の感動を呼び、サロン経営の強力な武器となります。
                </p>
                <div class="w-full max-w-3xl mx-auto mb-16 placeholder-bg h-96">
                    <span><img src="https://imgtu.com/uploads/js5slt7z/r-3_page-0001.webp" alt="3_page-0001.jpg" border="0"/></span>
                </div>
                
                <h3 class="text-2xl md:text-3xl font-bold text-center mb-12">サロンに選ばれる「３つの導入メリット」</h3>
                <div class="grid md:grid-cols-3 gap-8 max-w-6xl mx-auto">
                    <div class="bg-orange-50 p-8 rounded-lg shadow-lg border-t-4 border-amber-500">
                        <span class="text-4xl font-bold text-amber-500 block mb-3">01</span>
                        <h4 class="text-2xl font-semibold mb-4">視覚的なインパクトによる集客力</h4>
                        <p class="text-gray-600">足湯後の「水の色の変化」が明確な体感となり、お客様の驚きと満足度を高めます。これが口コミとなり、新規客を呼び込みます。</p>
                    </div>
                    <div class="bg-orange-50 p-8 rounded-lg shadow-lg border-t-4 border-amber-500">
                        <span class="text-4xl font-bold text-amber-500 block mb-3">02</span>
                        <h4 class="text-2xl font-semibold mb-4">既存メニューとの相乗効果</h4>
                        <p class="text-gray-600">施術前に利用することで、体の巡りをサポートし、マッサージやエステなどの効果を最大化します。高単価のセットメニュー化に最適です。
                        </p>
                    </div>
                    <div class="bg-orange-50 p-8 rounded-lg shadow-lg border-t-4 border-amber-500">
                        <span class="text-4xl font-bold text-amber-500 block mb-3">03</span>
                        <h4 class="text-2xl font-semibold mb-4">技術不要で安定運用</h4>
                        <p class="text-gray-600">機器を設置するだけなので、専門的な技術や研修は不要。人件費を抑え、安定した収益源を確保できます。</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="voice" class="py-20 bg-orange-50">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-16">
                    実際に導入されたサロン様から、<br class="md:hidden">
                    <span class="text-amber-600">喜びの声</span>が続々
                </h2>
                <div class="grid lg:grid-cols-2 gap-12 items-center mb-16">
                    <div class="bg-white p-8 rounded-lg shadow-xl">
                        <div class="placeholder-bg h-64 mb-6">
                            <span>【プレースホルダー：サロンの外観または内装】</span>
                        </div>
                        <h3 class="text-2xl font-semibold mb-4">「リピート率が30%向上！満足度が激変しました」</h3>
                        <p class="text-gray-700 text-lg mb-4">
                            "導入後、デトックス後の施術効果アップでお客様の満足度が激変しました。特に「体が軽くなった」という声が多く、施術とのセットメニューが人気に。結果、リピート率が30%も向上しました。"
                        </p>
                        <p class="text-gray-600 font-semibold text-right">（エステサロン経営・A様）</p>
                    </div>
                    <div class="bg-white p-8 rounded-lg shadow-xl">
                        <h3 class="text-2xl font-semibold text-center mb-4">A様サロンのリピート率変化</h3>
                        <p class="text-center text-gray-600 mb-6">導入前と導入後のリピート率（相対値）を可視化</p>
                        <div class="chart-container">
                            <canvas id="repeatRateChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="grid lg:grid-cols-2 gap-12 items-center">
                    <div class="bg-white p-8 rounded-lg shadow-xl lg:order-2">
                        <div class="placeholder-bg h-64 mb-6">
                            <span>【プレースホルダー：お客様が施術を受けている様子】</span>
                        </div>
                        <h3 class="text-2xl font-semibold mb-4">「広告費ゼロで新規のお客様が増えました」</h3>
                        <p class="text-gray-700 text-lg mb-4">
                            "「水の色が変わるのが面白い」と、お客様がご自身のSNSで発信してくれるようになりました。それを見たご友人からの問い合わせが増え、広告費を使わずに新規のお客様が増えています。"
                        </p>
                        <p class="text-gray-600 font-semibold text-right">（リラクゼーションサロン経営・B様）</p>
                    </div>
                    <div class="lg:order-1 flex items-center justify-center">
                        <p class="text-3xl font-bold text-gray-700 text-center px-8">
                            お客様の「<span class="text-amber-600">驚き</span>」が<br>
                            最高の「<span class="text-amber-600">口コミ</span>」を生む
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <section id="offer" class="py-20 bg-white">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-16">
                    導入を成功に導く、<br class="md:hidden">
                    メーカー公式の<span class="text-amber-600">徹底サポート</span>
                </h2>
                <div class="grid md:grid-cols-2 gap-8 max-w-5xl mx-auto">
                    <div class="bg-orange-50 p-8 rounded-lg shadow-lg text-center border-t-4 border-amber-500">
                        <div class="placeholder-bg h-56 w-full max-w-xs mx-auto mb-6">
                            <span>【プレースホルダー：ノウハウ資料の表紙】</span>
                        </div>
                        <h3 class="text-2xl font-semibold mb-3">特典 1：集客・運用ノウハウ資料</h3>
                        <p class="text-gray-600">「高単価メニューの作り方」「効果的なSNSでの訴求方法」など、売上最大化のための<span class="font-bold">公式虎の巻</span>を無料進呈。</p>
                    </div>
                    <div class="bg-orange-50 p-8 rounded-lg shadow-lg text-center border-t-4 border-amber-500">
                         <div class="placeholder-bg h-56 w-full max-w-xs mx-auto mb-6 flex items-center justify-center">
                            <span class="text-5xl">🤝</span>
                        </div>
                        <h3 class="text-2xl font-semibold mb-3">特典 2：専任担当者による経営相談</h3>
                        <p class="text-gray-600">あなたのサロンの形態に合わせた、最適な導入プラン、収益シミュレーションを<span class="font-bold">無料</span>でご提案します。</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="py-20 bg-orange-50">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-6">
                    まずは「GOD-CLEANER・GOLD」の<br class="md:hidden">
                    <span class="text-amber-600">全てをご確認ください</span>
                </h2>
                <p class="text-center text-lg text-gray-700 max-w-3xl mx-auto mb-12">
                    資料請求、詳細説明のご希望は、以下のフォームより承ります。<br>
                    専任の担当者が、あなたのサロンのお悩みに合わせて丁寧にご説明いたします。
                </p>

                <div id="form-success" class="hidden max-w-3xl mx-auto bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg text-center mb-8">
                    <strong class="font-bold">お問い合わせありがとうございます！</strong>
                    <span class="block sm:inline">送信が完了しました。担当者より折り返しご連絡いたします。</span>
                </div>
                
                <div id="form-error" class="hidden max-w-3xl mx-auto bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg text-center mb-8">
                    <strong class="font-bold">送信エラー</strong>
                    <span class="block sm:inline" id="error-message">お問い合わせの送信中に問題が発生しました。再度お試しください。</span>
                </div>

                <form id="contact-form" class="max-w-3xl mx-auto bg-white p-8 md:p-12 rounded-lg shadow-xl space-y-6">
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">形態 <span class="text-red-500">必須</span></label>
                        <div class="flex flex-wrap gap-x-6 gap-y-2">
                            <label class="inline-flex items-center">
                                <input type="radio" name="businessType" value="salon" class="form-radio text-amber-600" required>
                                <span class="ml-2">サロン・治療院</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="businessType" value="personal" class="form-radio text-amber-600">
                                <span class="ml-2">個人</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="businessType" value="other" class="form-radio text-amber-600">
                                <span class="ml-2">その他</span>
                            </label>
                        </div>
                    </div>
                    
                    <div id="salon-status" class="hidden pl-4 border-l-4 border-gray-200">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">現在の状況 <span class="text-red-500">必須</span></label>
                        <div class="flex flex-wrap gap-x-6 gap-y-2">
                            <label class="inline-flex items-center">
                                <input type="radio" name="salonStatus" value="open" class="form-radio text-amber-600">
                                <span class="ml-2">現在営業中</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="salonStatus" value="soon" class="form-radio text-amber-600">
                                <span class="ml-2">近々オープン予定</span>
                            </label>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">お問い合わせ項目 <span class="text-red-500">必須</span></label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" name="inquiry[]" value="doc" class="form-checkbox text-amber-600 rounded">
                                <span class="ml-2">詳細の資料希望</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="inquiry[]" value="exp" class="form-checkbox text-amber-600 rounded">
                                <span class="ml-2">体験できるお店希望</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="inquiry[]" value="staff" class="form-checkbox text-amber-600 rounded">
                                <span class="ml-2">専任担当者の説明を希望</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="inquiry[]" value="buy" class="form-checkbox text-amber-600 rounded">
                                <span class="ml-2">体験してよければ購入を希望</span>
                            </label>
                             <label class="flex items-center">
                                <input type="checkbox" name="inquiry[]" value="buy_done" class="form-checkbox text-amber-600 rounded">
                                <span class="ml-2">体験済みで購入を希望</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label for="company" class="block text-sm font-semibold text-gray-700">御社名 (屋号) <span class="text-red-500">必須</span></label>
                            <input type="text" id="company" name="company" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500">
                        </div>
                        <div>
                            <label for="name" class="block text-sm font-semibold text-gray-700">お名前 <span class="text-red-500">必須</span></label>
                            <input type="text" id="name" name="name" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500">
                        </div>
                    </div>
                     <div>
                        <label for="furigana" class="block text-sm font-semibold text-gray-700">ふりがな <span class="text-red-500">必須</span></label>
                        <input type="text" id="furigana" name="furigana" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500">
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label for="zip" class="block text-sm font-semibold text-gray-700">郵便番号 <span class="text-red-500">必須</span></label>
                            <input type="text" id="zip" name="zip" placeholder="例) 123-4567" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500">
                        </div>
                         <div>
                            <label for="prefecture" class="block text-sm font-semibold text-gray-700">都道府県 <span class="text-red-500">必須</span></label>
                            <input type="text" id="prefecture" name="prefecture" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500">
                        </div>
                    </div>
                    
                    <div>
                        <label for="city" class="block text-sm font-semibold text-gray-700">市区町村 <span class="text-red-500">必須</span></label>
                        <input type="text" id="city" name="city" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500">
                    </div>
                    
                     <div>
                        <label for="address" class="block text-sm font-semibold text-gray-700">それ以降の住所 <span class="text-red-500">必須</span></label>
                        <input type="text" id="address" name="address" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500">
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label for="phone" class="block text-sm font-semibold text-gray-700">電話番号 <span class="text-red-500">必須</span></label>
                            <input type="tel" id="phone" name="phone" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500">
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-semibold text-gray-700">メールアドレス <span class="text-red-500">必須</span></label>
                            <input type="email" id="email" name="email" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500">
                        </div>
                    </div>
                    
                    <div>
                        <label for="message" class="block text-sm font-semibold text-gray-700">メッセージ本文 (任意)</label>
                        <textarea id="message" name="message" rows="5" class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500"></textarea>
                    </div>
                    
                    <div class="text-center">
                         <p class="text-xs text-gray-500 mb-4">
                            <a href="#" class="underline hover:text-amber-600">プライバシーポリシー</a>をご確認の上、送信してください。
                        </p>
                        <button type="submit" id="submit-button" class="w-full max-w-md mx-auto bg-amber-600 text-white px-10 py-4 rounded-md font-bold text-lg hover:bg-amber-700 transition-colors shadow-xl">
                            上記の内容で送信する
                        </button>
                         <p id="loading-message" class="hidden text-amber-600 mt-4 font-semibold">送信中です...</p>
                    </div>
                </form>
            </div>
        </section>
    </main>

    <footer class="py-10 bg-gray-800 text-gray-400">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="space-x-6 mb-4">
                 <a href="#" class="hover:text-white">プライバシーポリシー</a>
                 <a href="#" class="hover:text-white">会社概要</a>
            </div>
            <p class="text-sm">&copy; 2023 Mind Fitness Co,Ltd. All Rights Reserved.</p>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // Firestore ログレベルをデバッグに設定
        setLogLevel('debug');
        
        // グローバル変数からFirebase設定と認証トークを取得
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let db = null;
        let auth = null;
        let isFirebaseReady = false;

        /**
         * Firebaseと認証を初期化する
         */
        async function initializeFirebase() {
            if (!firebaseConfig) {
                console.error("Firebase configuration is missing.");
                return;
            }

            try {
                const app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);

                // カスタムトークンまたは匿名認証でサインイン
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }
                isFirebaseReady = true;
                console.log("Firebase initialized and authenticated successfully.");
            } catch (error) {
                console.error("Error initializing Firebase or signing in:", error);
            }
        }
        
        /**
         * フォームからデータを収集する
         */
        function collectFormData(form) {
            const data = {};
            const formData = new FormData(form);

            // すべてのフィールドを収集
            for (const [key, value] of formData.entries()) {
                // チェックボックス（複数選択の可能性）の処理
                if (key.endsWith('[]')) {
                    const cleanKey = key.slice(0, -2);
                    if (!data[cleanKey]) {
                        data[cleanKey] = [];
                    }
                    data[cleanKey].push(value);
                } else if (data[key]) {
                     // 複数のラジオボタンがある場合の処理（ただし、ここでは不要なはず）
                     continue; 
                } else {
                    data[key] = value;
                }
            }
            
            // チェックボックスが一つも選択されていない場合の処理
            if (!data.inquiry) {
                data.inquiry = [];
            }
            
            // タイムスタンプを追加
            data.timestamp = new Date().toISOString();

            return data;
        }


        document.addEventListener('DOMContentLoaded', async () => {
            // Firebaseを初期化
            await initializeFirebase();
            
            const ctx = document.getElementById('repeatRateChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['導入前', '導入後 (A様サロン)'],
                    datasets: [{
                        label: 'リピート率 (相対値)',
                        data: [100, 130],
                        backgroundColor: [
                            'rgba(203, 213, 225, 0.6)', 
                            'rgba(217, 119, 6, 0.6)' 
                        ],
                        borderColor: [
                            'rgb(203, 213, 225)',
                            'rgb(217, 119, 6)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: '#e5e7eb'
                            }
                        },
                        x: {
                             grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y + ' (30% UP)';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            const contactForm = document.getElementById('contact-form');
            const formSuccess = document.getElementById('form-success');
            const formError = document.getElementById('form-error');
            const submitButton = document.getElementById('submit-button');
            const loadingMessage = document.getElementById('loading-message');
            const errorMessageDiv = document.getElementById('error-message');


            contactForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                if (!isFirebaseReady) {
                    errorMessageDiv.textContent = 'データベースの準備ができていません。しばらく待ってから再度お試しください。';
                    formError.classList.remove('hidden');
                    return;
                }

                formError.classList.add('hidden');
                submitButton.disabled = true;
                submitButton.classList.add('opacity-50', 'cursor-not-allowed');
                loadingMessage.classList.remove('hidden');

                const inquiryData = collectFormData(contactForm);

                try {
                    // Firestoreにデータを保存
                    // パス: /artifacts/{appId}/public/data/inquiries
                    const collectionPath = `artifacts/${appId}/public/data/inquiries`;
                    await addDoc(collection(db, collectionPath), inquiryData);
                    
                    console.log("Inquiry successfully saved to Firestore:", inquiryData);

                    // 成功時のUI更新
                    contactForm.classList.add('hidden');
                    formSuccess.classList.remove('hidden');
                    
                    window.scrollTo({ top: formSuccess.offsetTop - 100, behavior: 'smooth' });

                } catch (error) {
                    // エラー時のUI更新
                    console.error("Error writing document to Firestore: ", error);
                    errorMessageDiv.textContent = `送信中にエラーが発生しました: ${error.message}`;
                    formError.classList.remove('hidden');
                    
                    // ボタンを元に戻す
                    submitButton.disabled = false;
                    submitButton.classList.remove('opacity-50', 'cursor-not-allowed');
                    loadingMessage.classList.add('hidden');
                    
                    window.scrollTo({ top: formError.offsetTop - 100, behavior: 'smooth' });
                }
            });
            
            const businessTypeRadios = document.querySelectorAll('input[name="businessType"]');
            const salonStatusDiv = document.getElementById('salon-status');
            const salonStatusRadios = document.querySelectorAll('input[name="salonStatus"]');

            businessTypeRadios.forEach(radio => {
                radio.addEventListener('change', (e) => {
                    if (e.target.value === 'salon') {
                        salonStatusDiv.classList.remove('hidden');
                        salonStatusRadios.forEach(r => r.required = true);
                    } else {
                        salonStatusDiv.classList.add('hidden');
                         salonStatusRadios.forEach(r => {
                             r.required = false;
                             r.checked = false;
                         });
                    }
                });
            });
        });
    </script>

</body>
</html>
